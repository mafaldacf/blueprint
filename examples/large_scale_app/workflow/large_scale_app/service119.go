// Code generated by gen_workflow.go
package large_scale_app

import (
	"context"

	"github.com/blueprint-uservices/blueprint/runtime/core/backend"
	"go.mongodb.org/mongo-driver/bson"
)

type Service119Data struct {
	ID   string `bson:"id"`
	Data string `bson:"data"`
	DataTwo string `bson:"datatwo"`
	DataOther string `bson:"data_other"`
	DataOtherTwo string `bson:"datatwo_other"`
	DataOtherOther string `bson:"data_other_other"`
	DataOtherOtherTwo string `bson:"datatwo_other_other"`
}

type Service119 interface {
	Method119(ctx context.Context, id string, data string, datatwo string) (Service119Data, error)
	MethodOther119(ctx context.Context, id string, data string, datatwo string) (Service119Data, error)
	MethodOtherOther119(ctx context.Context, id string, data string, datatwo string) (Service119Data, error)
}

type Service119Impl struct {
	service119DB backend.NoSQLDatabase
	service120 Service120
}

func NewService119Impl(ctx context.Context, service119DB backend.NoSQLDatabase, service120 Service120) (Service119, error) {
	return &Service119Impl{
		service119DB: service119DB,
		service120: service120,
	}, nil
}

func (s *Service119Impl) Method119(ctx context.Context, id119 string, data119 string, datatwo119 string) (Service119Data, error) {
	// ----------------------- READ -----------------------
	coll, err := s.service119DB.GetCollection(ctx, "service119_db", "service119_data")
	if err != nil {
		return Service119Data{}, err
	}
	query := bson.D{
		{Key: "id", Value: id119},
	}
	res, err := coll.FindOne(ctx, query)
	if err != nil {
		return Service119Data{}, err
	}
	var service119Data Service119Data
	exists, err := res.One(ctx, &service119Data)
	if err != nil {
		return Service119Data{}, err
	}
	if exists {
		return service119Data, nil
	}

	// ----------------------- WRITE -----------------------
	coll, err = s.service119DB.GetCollection(ctx, "service119_db", "service119_data")
	if err != nil {
		return Service119Data{}, err
	}
	service119Data = Service119Data{
		ID:   id119,
		Data: data119,
	}
	if err := coll.InsertOne(ctx, service119Data); err != nil {
		return Service119Data{}, err
	}

	// ----------------------- WRITE v2 -----------------------
	coll, err = s.service119DB.GetCollection(ctx, "service119_db", "service119_data")
	if err != nil {
		return Service119Data{}, err
	}
	service119Data = Service119Data{
		ID:   id119,
		DataTwo: datatwo119,
	}
	if err := coll.InsertOne(ctx, service119Data); err != nil {
		return Service119Data{}, err
	}

	// call the next service in the chain
	if _, err := s.service120.Method120(ctx, id119, data119, datatwo119); err != nil {
		return Service119Data{}, err
	}

	return service119Data, nil
}

func (s *Service119Impl) MethodOther119(ctx context.Context, id119 string, data119 string, datatwo119 string) (Service119Data, error) {
	// ----------------------- READ -----------------------
	coll, err := s.service119DB.GetCollection(ctx, "service119_db", "service119_data")
	if err != nil {
		return Service119Data{}, err
	}
	query := bson.D{
		{Key: "id", Value: id119},
	}
	res, err := coll.FindOne(ctx, query)
	if err != nil {
		return Service119Data{}, err
	}
	var service119Data Service119Data
	exists, err := res.One(ctx, &service119Data)
	if err != nil {
		return Service119Data{}, err
	}
	if exists {
		return service119Data, nil
	}

	// ----------------------- WRITE -----------------------
	coll, err = s.service119DB.GetCollection(ctx, "service119_db", "service119_data")
	if err != nil {
		return Service119Data{}, err
	}
	service119Data = Service119Data{
		ID:   id119,
		DataOther: data119,
	}
	if err := coll.InsertOne(ctx, service119Data); err != nil {
		return Service119Data{}, err
	}

	// ----------------------- WRITE v2 -----------------------
	coll, err = s.service119DB.GetCollection(ctx, "service119_db", "service119_data")
	if err != nil {
		return Service119Data{}, err
	}
	service119Data = Service119Data{
		ID:   id119,
		DataOtherTwo: datatwo119,
	}
	if err := coll.InsertOne(ctx, service119Data); err != nil {
		return Service119Data{}, err
	}

	// call the next service in the chain
	if _, err := s.service120.MethodOther120(ctx, id119, data119, datatwo119); err != nil {
		return Service119Data{}, err
	}

	return service119Data, nil
}

func (s *Service119Impl) MethodOtherOther119(ctx context.Context, id119 string, data119 string, datatwo119 string) (Service119Data, error) {
	// ----------------------- READ -----------------------
	coll, err := s.service119DB.GetCollection(ctx, "service119_db", "service119_data")
	if err != nil {
		return Service119Data{}, err
	}
	query := bson.D{
		{Key: "id", Value: id119},
	}
	res, err := coll.FindOne(ctx, query)
	if err != nil {
		return Service119Data{}, err
	}
	var service119Data Service119Data
	exists, err := res.One(ctx, &service119Data)
	if err != nil {
		return Service119Data{}, err
	}
	if exists {
		return service119Data, nil
	}

	// ----------------------- WRITE -----------------------
	coll, err = s.service119DB.GetCollection(ctx, "service119_db", "service119_data")
	if err != nil {
		return Service119Data{}, err
	}
	service119Data = Service119Data{
		ID:   id119,
		DataOtherOther: data119,
	}
	if err := coll.InsertOne(ctx, service119Data); err != nil {
		return Service119Data{}, err
	}

	// ----------------------- WRITE v2 -----------------------
	coll, err = s.service119DB.GetCollection(ctx, "service119_db", "service119_data")
	if err != nil {
		return Service119Data{}, err
	}
	service119Data = Service119Data{
		ID:   id119,
		DataOtherOtherTwo: datatwo119,
	}
	if err := coll.InsertOne(ctx, service119Data); err != nil {
		return Service119Data{}, err
	}

	// call the next service in the chain
	if _, err := s.service120.MethodOtherOther120(ctx, id119, data119, datatwo119); err != nil {
		return Service119Data{}, err
	}

	return service119Data, nil
}
