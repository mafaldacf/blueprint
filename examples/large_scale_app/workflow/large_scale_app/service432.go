// Code generated by gen_workflow.go
package large_scale_app

import (
	"context"

	"github.com/blueprint-uservices/blueprint/runtime/core/backend"
	"go.mongodb.org/mongo-driver/bson"
)

type Service432Data struct {
	ID   string `bson:"id"`
	Data string `bson:"data"`
	DataTwo string `bson:"datatwo"`
	DataOther string `bson:"data_other"`
	DataOtherTwo string `bson:"datatwo_other"`
	DataOtherOther string `bson:"data_other_other"`
	DataOtherOtherTwo string `bson:"datatwo_other_other"`
}

type Service432 interface {
	Method432(ctx context.Context, id string, data string, datatwo string) (Service432Data, error)
	MethodOther432(ctx context.Context, id string, data string, datatwo string) (Service432Data, error)
	MethodOtherOther432(ctx context.Context, id string, data string, datatwo string) (Service432Data, error)
}

type Service432Impl struct {
	service432DB backend.NoSQLDatabase
	service433 Service433
}

func NewService432Impl(ctx context.Context, service432DB backend.NoSQLDatabase, service433 Service433) (Service432, error) {
	return &Service432Impl{
		service432DB: service432DB,
		service433: service433,
	}, nil
}

func (s *Service432Impl) Method432(ctx context.Context, id432 string, data432 string, datatwo432 string) (Service432Data, error) {
	// ----------------------- READ -----------------------
	coll, err := s.service432DB.GetCollection(ctx, "service432_db", "service432_data")
	if err != nil {
		return Service432Data{}, err
	}
	query := bson.D{
		{Key: "id", Value: id432},
	}
	res, err := coll.FindOne(ctx, query)
	if err != nil {
		return Service432Data{}, err
	}
	var service432Data Service432Data
	exists, err := res.One(ctx, &service432Data)
	if err != nil {
		return Service432Data{}, err
	}
	if exists {
		return service432Data, nil
	}

	// ----------------------- WRITE -----------------------
	coll, err = s.service432DB.GetCollection(ctx, "service432_db", "service432_data")
	if err != nil {
		return Service432Data{}, err
	}
	service432Data = Service432Data{
		ID:   id432,
		Data: data432,
	}
	if err := coll.InsertOne(ctx, service432Data); err != nil {
		return Service432Data{}, err
	}

	// ----------------------- WRITE v2 -----------------------
	coll, err = s.service432DB.GetCollection(ctx, "service432_db", "service432_data")
	if err != nil {
		return Service432Data{}, err
	}
	service432Data = Service432Data{
		ID:   id432,
		DataTwo: datatwo432,
	}
	if err := coll.InsertOne(ctx, service432Data); err != nil {
		return Service432Data{}, err
	}

	// call the next service in the chain
	if _, err := s.service433.Method433(ctx, id432, data432, datatwo432); err != nil {
		return Service432Data{}, err
	}

	return service432Data, nil
}

func (s *Service432Impl) MethodOther432(ctx context.Context, id432 string, data432 string, datatwo432 string) (Service432Data, error) {
	// ----------------------- READ -----------------------
	coll, err := s.service432DB.GetCollection(ctx, "service432_db", "service432_data")
	if err != nil {
		return Service432Data{}, err
	}
	query := bson.D{
		{Key: "id", Value: id432},
	}
	res, err := coll.FindOne(ctx, query)
	if err != nil {
		return Service432Data{}, err
	}
	var service432Data Service432Data
	exists, err := res.One(ctx, &service432Data)
	if err != nil {
		return Service432Data{}, err
	}
	if exists {
		return service432Data, nil
	}

	// ----------------------- WRITE -----------------------
	coll, err = s.service432DB.GetCollection(ctx, "service432_db", "service432_data")
	if err != nil {
		return Service432Data{}, err
	}
	service432Data = Service432Data{
		ID:   id432,
		DataOther: data432,
	}
	if err := coll.InsertOne(ctx, service432Data); err != nil {
		return Service432Data{}, err
	}

	// ----------------------- WRITE v2 -----------------------
	coll, err = s.service432DB.GetCollection(ctx, "service432_db", "service432_data")
	if err != nil {
		return Service432Data{}, err
	}
	service432Data = Service432Data{
		ID:   id432,
		DataOtherTwo: datatwo432,
	}
	if err := coll.InsertOne(ctx, service432Data); err != nil {
		return Service432Data{}, err
	}

	// call the next service in the chain
	if _, err := s.service433.MethodOther433(ctx, id432, data432, datatwo432); err != nil {
		return Service432Data{}, err
	}

	return service432Data, nil
}

func (s *Service432Impl) MethodOtherOther432(ctx context.Context, id432 string, data432 string, datatwo432 string) (Service432Data, error) {
	// ----------------------- READ -----------------------
	coll, err := s.service432DB.GetCollection(ctx, "service432_db", "service432_data")
	if err != nil {
		return Service432Data{}, err
	}
	query := bson.D{
		{Key: "id", Value: id432},
	}
	res, err := coll.FindOne(ctx, query)
	if err != nil {
		return Service432Data{}, err
	}
	var service432Data Service432Data
	exists, err := res.One(ctx, &service432Data)
	if err != nil {
		return Service432Data{}, err
	}
	if exists {
		return service432Data, nil
	}

	// ----------------------- WRITE -----------------------
	coll, err = s.service432DB.GetCollection(ctx, "service432_db", "service432_data")
	if err != nil {
		return Service432Data{}, err
	}
	service432Data = Service432Data{
		ID:   id432,
		DataOtherOther: data432,
	}
	if err := coll.InsertOne(ctx, service432Data); err != nil {
		return Service432Data{}, err
	}

	// ----------------------- WRITE v2 -----------------------
	coll, err = s.service432DB.GetCollection(ctx, "service432_db", "service432_data")
	if err != nil {
		return Service432Data{}, err
	}
	service432Data = Service432Data{
		ID:   id432,
		DataOtherOtherTwo: datatwo432,
	}
	if err := coll.InsertOne(ctx, service432Data); err != nil {
		return Service432Data{}, err
	}

	// call the next service in the chain
	if _, err := s.service433.MethodOtherOther433(ctx, id432, data432, datatwo432); err != nil {
		return Service432Data{}, err
	}

	return service432Data, nil
}
