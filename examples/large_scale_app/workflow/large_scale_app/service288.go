// Code generated by gen_workflow.go
package large_scale_app

import (
	"context"

	"github.com/blueprint-uservices/blueprint/runtime/core/backend"
	"go.mongodb.org/mongo-driver/bson"
)

type Service288Data struct {
	ID   string `bson:"id"`
	Data string `bson:"data"`
	DataTwo string `bson:"datatwo"`
	DataOther string `bson:"data_other"`
	DataOtherTwo string `bson:"datatwo_other"`
	DataOtherOther string `bson:"data_other_other"`
	DataOtherOtherTwo string `bson:"datatwo_other_other"`
}

type Service288 interface {
	Method288(ctx context.Context, id string, data string, datatwo string) (Service288Data, error)
	MethodOther288(ctx context.Context, id string, data string, datatwo string) (Service288Data, error)
	MethodOtherOther288(ctx context.Context, id string, data string, datatwo string) (Service288Data, error)
}

type Service288Impl struct {
	service288DB backend.NoSQLDatabase
	service289 Service289
}

func NewService288Impl(ctx context.Context, service288DB backend.NoSQLDatabase, service289 Service289) (Service288, error) {
	return &Service288Impl{
		service288DB: service288DB,
		service289: service289,
	}, nil
}

func (s *Service288Impl) Method288(ctx context.Context, id288 string, data288 string, datatwo288 string) (Service288Data, error) {
	// ----------------------- READ -----------------------
	coll, err := s.service288DB.GetCollection(ctx, "service288_db", "service288_data")
	if err != nil {
		return Service288Data{}, err
	}
	query := bson.D{
		{Key: "id", Value: id288},
	}
	res, err := coll.FindOne(ctx, query)
	if err != nil {
		return Service288Data{}, err
	}
	var service288Data Service288Data
	exists, err := res.One(ctx, &service288Data)
	if err != nil {
		return Service288Data{}, err
	}
	if exists {
		return service288Data, nil
	}

	// ----------------------- WRITE -----------------------
	coll, err = s.service288DB.GetCollection(ctx, "service288_db", "service288_data")
	if err != nil {
		return Service288Data{}, err
	}
	service288Data = Service288Data{
		ID:   id288,
		Data: data288,
	}
	if err := coll.InsertOne(ctx, service288Data); err != nil {
		return Service288Data{}, err
	}

	// ----------------------- WRITE v2 -----------------------
	coll, err = s.service288DB.GetCollection(ctx, "service288_db", "service288_data")
	if err != nil {
		return Service288Data{}, err
	}
	service288Data = Service288Data{
		ID:   id288,
		DataTwo: datatwo288,
	}
	if err := coll.InsertOne(ctx, service288Data); err != nil {
		return Service288Data{}, err
	}

	// call the next service in the chain
	if _, err := s.service289.Method289(ctx, id288, data288, datatwo288); err != nil {
		return Service288Data{}, err
	}

	return service288Data, nil
}

func (s *Service288Impl) MethodOther288(ctx context.Context, id288 string, data288 string, datatwo288 string) (Service288Data, error) {
	// ----------------------- READ -----------------------
	coll, err := s.service288DB.GetCollection(ctx, "service288_db", "service288_data")
	if err != nil {
		return Service288Data{}, err
	}
	query := bson.D{
		{Key: "id", Value: id288},
	}
	res, err := coll.FindOne(ctx, query)
	if err != nil {
		return Service288Data{}, err
	}
	var service288Data Service288Data
	exists, err := res.One(ctx, &service288Data)
	if err != nil {
		return Service288Data{}, err
	}
	if exists {
		return service288Data, nil
	}

	// ----------------------- WRITE -----------------------
	coll, err = s.service288DB.GetCollection(ctx, "service288_db", "service288_data")
	if err != nil {
		return Service288Data{}, err
	}
	service288Data = Service288Data{
		ID:   id288,
		DataOther: data288,
	}
	if err := coll.InsertOne(ctx, service288Data); err != nil {
		return Service288Data{}, err
	}

	// ----------------------- WRITE v2 -----------------------
	coll, err = s.service288DB.GetCollection(ctx, "service288_db", "service288_data")
	if err != nil {
		return Service288Data{}, err
	}
	service288Data = Service288Data{
		ID:   id288,
		DataOtherTwo: datatwo288,
	}
	if err := coll.InsertOne(ctx, service288Data); err != nil {
		return Service288Data{}, err
	}

	// call the next service in the chain
	if _, err := s.service289.MethodOther289(ctx, id288, data288, datatwo288); err != nil {
		return Service288Data{}, err
	}

	return service288Data, nil
}

func (s *Service288Impl) MethodOtherOther288(ctx context.Context, id288 string, data288 string, datatwo288 string) (Service288Data, error) {
	// ----------------------- READ -----------------------
	coll, err := s.service288DB.GetCollection(ctx, "service288_db", "service288_data")
	if err != nil {
		return Service288Data{}, err
	}
	query := bson.D{
		{Key: "id", Value: id288},
	}
	res, err := coll.FindOne(ctx, query)
	if err != nil {
		return Service288Data{}, err
	}
	var service288Data Service288Data
	exists, err := res.One(ctx, &service288Data)
	if err != nil {
		return Service288Data{}, err
	}
	if exists {
		return service288Data, nil
	}

	// ----------------------- WRITE -----------------------
	coll, err = s.service288DB.GetCollection(ctx, "service288_db", "service288_data")
	if err != nil {
		return Service288Data{}, err
	}
	service288Data = Service288Data{
		ID:   id288,
		DataOtherOther: data288,
	}
	if err := coll.InsertOne(ctx, service288Data); err != nil {
		return Service288Data{}, err
	}

	// ----------------------- WRITE v2 -----------------------
	coll, err = s.service288DB.GetCollection(ctx, "service288_db", "service288_data")
	if err != nil {
		return Service288Data{}, err
	}
	service288Data = Service288Data{
		ID:   id288,
		DataOtherOtherTwo: datatwo288,
	}
	if err := coll.InsertOne(ctx, service288Data); err != nil {
		return Service288Data{}, err
	}

	// call the next service in the chain
	if _, err := s.service289.MethodOtherOther289(ctx, id288, data288, datatwo288); err != nil {
		return Service288Data{}, err
	}

	return service288Data, nil
}
